<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Memory Game ‚Äî no shake</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; transition: background 0.35s, color 0.35s; }
body { font-family: 'Poppins', sans-serif; min-height:100vh; display:flex; flex-direction:column; align-items:center; padding:20px; }

body.dark { background: radial-gradient(circle at top left, #6a11cb, #2575fc); color:#fff; }
body.light { background: radial-gradient(circle at top left, #f9f9f9, #ececec); color:#333; }

h1 { margin:20px 0; font-weight:700; text-shadow:2px 2px 8px rgba(0,0,0,0.25); font-size:2.2rem; }

.controls { display:flex; gap:12px; align-items:center; margin-bottom:12px; flex-wrap:wrap; justify-content:center; }
select, button { padding:10px 14px; border-radius:8px; border:none; font-size:1rem; cursor:pointer; transition:0.2s; }
select { background: rgba(255,255,255,0.95); color:#222; }
button { background:#ff4081; color:#fff; box-shadow:0 4px 10px rgba(0,0,0,0.2); }
button:hover { transform:translateY(-2px); }
.theme-toggle { background:transparent; font-size:1.4rem; border:none; cursor:pointer; color:inherit; }

.game-info { font-size:1.05rem; background: rgba(0,0,0,0.18); padding:8px 12px; border-radius:10px; margin-bottom:14px; display:flex; gap:12px; }
body.light .game-info { background: rgba(0,0,0,0.06); }

.game-board { display:grid; gap:10px; width:90vmin; max-width:900px; }

.card { position:relative; perspective:1000px; cursor:pointer; }
.card-inner { position:relative; width:100%; padding-top:100%; transform-style:preserve-3d; transition: transform 0.5s; -webkit-transform-style: preserve-3d; }
.card.flipped .card-inner { transform: rotateY(180deg); }

.card-face {
  position:absolute; top:0; left:0; width:100%; height:100%;
  border-radius:12px; display:flex; align-items:center; justify-content:center;
  font-size: clamp(1.5rem, 3vmin, 3rem);
  -webkit-backface-visibility: hidden; backface-visibility: hidden;
  box-shadow: 0 5px 15px rgba(0,0,0,0.22);
}

.card-front { background: linear-gradient(45deg, #ff7e5f, #feb47b); }
.card-back { background: #fff; color:#222; transform: rotateY(180deg); }

.card.matched .card-back {
  background: linear-gradient(45deg,#00c9ff,#92fe9d);
  color:#000;
  animation: glow 1s ease;
}

@keyframes glow { 
  0%{box-shadow:0 0 5px #00ffcc} 
  50%{box-shadow:0 0 30px #00ffcc} 
  100%{box-shadow:0 0 5px #00ffcc} 
}

.victory { animation: victoryFlash 1.5s ease; }
@keyframes victoryFlash {
  0%,100%{ background: radial-gradient(circle,#6a11cb,#2575fc); }
  50%{ background: radial-gradient(circle,#00c9ff,#92fe9d); }
}

@media (max-width:600px){ .game-info{ font-size:0.9rem; justify-content:center; } }
</style>
</head>
<body>
  <h1>üß† Memory Game Deluxe</h1>

  <div class="controls">
    <button class="theme-toggle" id="themeToggle" title="Toggle Theme">üåô</button>
    <label for="level">Level:</label>
    <select id="level">
      <option value="4">Easy (4x4)</option>
      <option value="6">Medium (6x6)</option>
      <option value="8">Hard (8x8)</option>
      <option value="10">Insane (10x10)</option>
    </select>
    <button id="restart">Restart</button>
  </div>

  <div class="game-info">
    ‚è± <span id="timer">0</span>s |
    Moves: <span id="moves">0</span> |
    Matches: <span id="matches">0</span>
  </div>

  <div class="game-board" id="gameBoard"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const gameBoard = document.getElementById('gameBoard');
  const movesDisplay = document.getElementById('moves');
  const matchesDisplay = document.getElementById('matches');
  const timerDisplay = document.getElementById('timer');
  const restartButton = document.getElementById('restart');
  const levelSelect = document.getElementById('level');
  const themeToggle = document.getElementById('themeToggle');

  let cards = [];
  let flippedCards = [];
  let moves = 0;
  let matchedPairs = 0;
  let lockBoard = false;
  let totalPairs = 8;

  let revealTimeout = null;
  let hideTimeout = null;
  let intervalId = null;
  let startTime = 0;

  const emojis = ['üçé','üçå','üçá','üçä','üçì','üçí','üçë','üçç','ü•ù','üçâ','ü••','üçã','üçà','üçè','üçê','ü•ï','üê±','üåΩ','ü•¶','üßÑ','üßÖ','ü•î','üç†','üçû','ü•®','üßÄ','üçó','üçñ','üç§','üç£','üçï','üçî','üçü','üå≠','ü•™','ü•ó','üçù','üç∞','üç™','üç©','üçø','üßä','üç´','üç¨','üç≠','ü•ß','ü•Æ','üçØ','‚òï','üçµ','üç∫','üç∏','üç∑','üçπ'];

  function clearTimers() {
    [revealTimeout, hideTimeout, intervalId].forEach(t => { if (t) clearTimeout(t) || clearInterval(t); });
    revealTimeout = hideTimeout = intervalId = null;
  }

  function startTimer() {
    startTime = Date.now();
    timerDisplay.textContent = 0;
    intervalId = setInterval(() => {
      timerDisplay.textContent = Math.floor((Date.now() - startTime) / 1000);
    }, 1000);
  }

  function initGame(size = 4) {
    clearTimers();
    moves = 0;
    matchedPairs = 0;
    flippedCards = [];
    cards = [];
    lockBoard = true;
    movesDisplay.textContent = 0;
    matchesDisplay.textContent = 0;
    timerDisplay.textContent = 0;
    gameBoard.innerHTML = '';

    totalPairs = (size * size) / 2;
    const chosen = emojis.slice(0, totalPairs);
    const gameCards = [...chosen, ...chosen].sort(() => Math.random() - 0.5);
    gameBoard.style.gridTemplateColumns = `repeat(${size}, 1fr)`;

    gameCards.forEach(emoji => {
      const card = document.createElement('div');
      card.classList.add('card');
      card.dataset.emoji = emoji;
      card.innerHTML = `
        <div class="card-inner">
          <div class="card-face card-front">?</div>
          <div class="card-face card-back">${emoji}</div>
        </div>
      `;
      card.addEventListener('click', flipCard);
      gameBoard.appendChild(card);
      cards.push(card);
    });

    revealTimeout = setTimeout(() => {
      cards.forEach(c => c.classList.add('flipped'));
      hideTimeout = setTimeout(() => {
        cards.forEach(c => c.classList.remove('flipped'));
        startTimer();
        lockBoard = false;
      }, 1000);
    }, 100);
  }

  function flipCard() {
    if (lockBoard) return;
    if (this.classList.contains('flipped') || this.classList.contains('matched')) return;

    this.classList.add('flipped');
    flippedCards.push(this);

    if (flippedCards.length === 2) {
      lockBoard = true;
      moves++;
      movesDisplay.textContent = moves;
      checkMatch();
    }
  }

  function checkMatch() {
    const [a,b] = flippedCards;
    if (a.dataset.emoji === b.dataset.emoji) matchFound();
    else unflipCards();
  }

  function matchFound() {
    flippedCards.forEach(c => {
      c.classList.add('matched');
      c.removeEventListener('click', flipCard);
    });
    matchedPairs++;
    matchesDisplay.textContent = matchedPairs;
    flippedCards = [];
    lockBoard = false;

    if (matchedPairs === totalPairs) {
      clearInterval(intervalId);
      document.body.classList.add('victory');
      setTimeout(() => {
        const t = Math.floor((Date.now() - startTime) / 1000);
        alert(`üéâ –ü–æ–±–µ–¥–∞! ${moves} —Ö–æ–¥–æ–≤ –∑–∞ ${t} —Å–µ–∫—É–Ω–¥`);
        document.body.classList.remove('victory');
      }, 500);
    }
  }

  function unflipCards() {
    setTimeout(() => {
      flippedCards.forEach(c => c.classList.remove('flipped'));
      flippedCards = [];
      lockBoard = false;
    }, 500);
  }

  restartButton.addEventListener('click', () => initGame(parseInt(levelSelect.value)));
  levelSelect.addEventListener('change', () => initGame(parseInt(levelSelect.value)));

  function setTheme(mode) {
    document.body.className = mode;
    localStorage.setItem('theme', mode);
    themeToggle.textContent = mode === 'dark' ? 'üåô' : 'üåû';
  }
  themeToggle.addEventListener('click', () => {
    const current = document.body.classList.contains('dark') ? 'dark' : 'light';
    setTheme(current === 'dark' ? 'light' : 'dark');
  });
  setTheme(localStorage.getItem('theme') || 'dark');

  initGame();
});
</script>
</body>
</html>